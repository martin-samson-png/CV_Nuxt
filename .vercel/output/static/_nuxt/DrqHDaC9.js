import{c as d,o,a as u,t as _,h as y,i as h,j,F as q,r as b,k as f,d as g,v as A,l as S,m as U,n as N,_ as x,g as w,f as z,b as $,p as I}from"./DCTMm3B-.js";const V={class:"progress"},E=["value","max"],O={__name:"UiProgressService",props:{value:Number,max:Number},setup(i){return(t,l)=>(o(),d("div",V,[u("div",null,"Etape "+_(i.value+1)+"/"+_(i.max+1),1),u("progress",{value:i.value,max:i.max},null,8,E)]))}},Q={class:"question"},B={class:"content-section"},C={key:0},M=["for"],T=["id","value"],P={key:1},R=["for"],D=["id","value"],F={key:2},L=["min","max"],G={class:"btn-section"},H=["disabled"],J={__name:"UiQuestionService",props:{question:Object},emits:["answer"],setup(i,{emit:t}){const l=i,n=y(null),v=t,r=h(()=>{switch(l.question.type){case"single":return n.value!==null;case"number":return typeof n.value=="number"&&!Number.isNaN(n.value);case"multi":return Array.isArray(n.value)}});return j(()=>l.question,a=>{a.type==="single"?n.value=null:a.type==="number"?n.value=0:a.type==="multi"&&(n.value=[])}),(a,s)=>(o(),d("div",Q,[u("div",B,[u("h3",null,_(i.question.title)+" :",1),i.question.type==="single"?(o(),d("ul",C,[(o(!0),d(q,null,b(i.question.options,(e,c)=>(o(),d("li",{key:e.id},[u("label",{for:`answer${c}`},[f(u("input",{id:`answer${c}`,type:"radio",name:"answer","onUpdate:modelValue":s[0]||(s[0]=m=>n.value=m),value:e.label},null,8,T),[[A,n.value]]),g(" "+_(e.label),1)],8,M)]))),128))])):i.question.type==="multi"?(o(),d("ul",P,[(o(!0),d(q,null,b(i.question.options,(e,c)=>(o(),d("li",{key:e.id},[u("label",{for:`answer${c}`},[f(u("input",{type:"checkbox",id:`answer${c}`,value:e.id,"onUpdate:modelValue":s[1]||(s[1]=m=>n.value=m)},null,8,D),[[S,n.value]]),g(_(e.label),1)],8,R)]))),128))])):(o(),d("div",F,[f(u("input",{type:"number",min:i.question.min,max:i.question.max,"onUpdate:modelValue":s[2]||(s[2]=e=>n.value=e)},null,8,L),[[U,n.value,void 0,{number:!0}]])]))]),u("div",G,[u("button",{class:N(r.value?"btn-primary":"btn-disabled"),disabled:!r.value,onClick:s[3]||(s[3]=e=>v("answer",n.value))}," Question suivante ",10,H)])]))}},K={class:"recap"},W={class:"total"},X={class:"price"},Y={__name:"UiRecapService",props:{quiz:Object,answers:Array},setup(i){const t=i,l=h(()=>{if(!t?.quiz?.steps?.length)return 0;let r=[],a=0;return t.quiz.steps.forEach((s,e)=>{if(Array.isArray(s.options)&&s.type==="single"){const c=s.options.findIndex(p=>Object.values(p).includes(t.answers?.[e])),m=s.options?.[c]?.impact;m?.type==="days"&&(r.push({price:t.quiz.tjm*m.value,answer:t.answers[e]}),a+=t.quiz.tjm*m.value)}if(s.type==="number"){const c=s.perUnitImpact;c?.type==="days"&&(a+=t.quiz.tjm*(t.answers[e]*c.value),r.push({price:t.quiz.tjm*(t.answers[e]*c.value),answer:t.answers[e]}))}Array.isArray(s.options)&&s.type==="multi"&&t?.answers?.[e]?.map(c=>{const m=s.options.findIndex(k=>Object.values(k).includes(c)),p=s.options?.[m]?.impact;p?.type==="days"&&(a+=t.quiz.tjm*p.value,r.push({price:t.quiz.tjm*p.value,answer:t.answers[e]})),p?.type==="fixed"&&(a+=p.value,r.push({price:p.value,answer:t.answers[e]}))})}),{total:a,prices:r}}),n=(r,a)=>Array.isArray(r)&&Array.isArray(a)&&r.length===a.length&&r.every((s,e)=>Object.is(s,a[e])),v=h(()=>{const r=l.value.prices??[];let a=[];for(let s=0;s<r.length-1;s++){const e=r[s],c=r[s+1];Array.isArray(e.answer)&&e.answer.length>1&&n(e.answer,c.answer)?a.push({price:e.price+c.price,answer:e.answer}):a.push({price:e.price,answer:e.answer})}return a});return console.log(v.value),(r,a)=>(o(),d("div",K,[a[1]||(a[1]=u("h3",null,"Estimation:",-1)),u("ul",null,[(o(!0),d(q,null,b(v.value,(s,e)=>(o(),d("li",null,_(i.quiz?.steps?.[e]?.title)+" : "+_(s.answer)+" "+_(s.price),1))),256))]),u("div",W,[a[0]||(a[0]=u("span",null,"Total :",-1)),u("span",X,_(l.value.total)+" €",1)])]))}},Z=x(Y,[["__scopeId","data-v-186779e2"]]),ee={class:"quiz"},se={class:"section"},te={key:0,class:"main"},ne={__name:"UiQuizService",props:{quiz:Object},setup(i){const t=i,l=y("question"),n=y(t.quiz.steps.map(()=>null)),v=y(0),r=h(()=>t.quiz.steps[v.value]),a=s=>{n.value[v.value]=s,v.value===t.quiz.steps.length-1?l.value="recap":v.value++};return(s,e)=>{const c=O,m=J,p=Z;return o(),d("div",ee,[e[0]||(e[0]=u("div",{class:"section"},[u("h1",null,"Services & Tarifs")],-1)),u("div",se,[$(c,{value:v.value,max:i.quiz.steps.length-1},null,8,["value","max"])]),l.value==="question"?(o(),d("div",te,[$(m,{question:r.value,onAnswer:a},null,8,["question"])])):w("",!0),l.value==="recap"?(o(),z(p,{key:1,answers:n.value,quiz:i.quiz},null,8,["answers","quiz"])):w("",!0)])}}},ae=x(ne,[["__scopeId","data-v-42b1409d"]]),ie={class:"container"},re={key:0},ue=["aria-busy"],oe={__name:"SectionsServiceSection",setup(i){const t=y(null),l=y("loading");return I(()=>{fetch("/quiz.json").then(n=>{if(n.ok)return n.json();throw new Error("Impossible de récupérer le json")}).then(n=>{t.value=n,l.value="idle"}).catch(n=>{l.value="error"})}),(n,v)=>{const r=ae;return o(),d("div",ie,[l.value==="error"?(o(),d("div",re,[...v[0]||(v[0]=[u("p",null,"Impossible de charger le questionnaire",-1)])])):w("",!0),u("div",{"aria-busy":l.value==="loading"},[l.value==="idle"&&t.value?(o(),z(r,{key:0,quiz:t.value},null,8,["quiz"])):w("",!0)],8,ue)])}}},le={};function ce(i,t){const l=oe;return o(),z(l)}const ve=x(le,[["render",ce]]);export{ve as default};
